<!doctype html>
<html lang="tr">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Butonlu Sayfa â€” Salt Okunur</title>
<style>
:root{ --bg:#0b0f17; --card:#0b1220; --accent:#00b894; --muted:#9fb0c8; --btn:#142235; }
*{box-sizing:border-box}
body{margin:0;font-family:Inter,system-ui,Roboto,-apple-system,Segoe UI,Arial;color:#e6eef8;
background:linear-gradient(180deg,#051026 0%,var(--bg) 100%);display:flex;align-items:center;justify-content:center;min-height:100vh;padding:20px}
.container{width:100%;max-width:720px;padding:18px;border-radius:16px;background:var(--card);box-shadow:0 12px 40px rgba(2,6,23,0.6)}
.header{display:flex;gap:12px;align-items:center;margin-bottom:14px}
.logo{width:56px;height:56px;border-radius:12px;background:linear-gradient(180deg,rgba(255,255,255,0.03),transparent);display:flex;align-items:center;justify-content:center;border:1px solid rgba(255,255,255,0.03)}
.logo strong{color:var(--accent)}
h1{font-size:18px;margin:0}
.lead{font-size:13px;color:var(--muted);margin-top:4px}
.buttons{display:flex;flex-direction:column;gap:12px;margin-top:12px}
.btn{display:flex;align-items:center;gap:12px;padding:14px;border-radius:12px;background:var(--btn);border:1px solid rgba(255,255,255,0.02);cursor:pointer;overflow:hidden}
.btn:hover{transform:translateY(-3px);transition:transform .15s}
.icon{width:48px;height:48px;border-radius:10px;display:flex;align-items:center;justify-content:center;background:rgba(255,255,255,0.02);flex-shrink:0;font-size:20px}
.label{font-weight:700;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;max-width:60%}
.sublabel{font-size:12px;color:var(--muted);white-space:nowrap;overflow:hidden;text-overflow:ellipsis;max-width:35%}
.footer{margin-top:12px;font-size:12px;color:var(--muted);text-align:center}
</style>
</head>
<body>
<div class="container" role="application" aria-label="Butonlu Sayfa">
  <div class="header">
    <div class="logo"><strong>SB</strong></div>
    <div>
      <h1>Butonlu Sayfa</h1>
      <div class="lead">Salt okunur â€” <code>butonlar.json</code> dosyan nasÄ±lsa Ã¶yle gÃ¶rÃ¼nÃ¼r</div>
    </div>
  </div>

  <div class="buttons" id="buttons" aria-live="polite"></div>
  <div class="footer">Kaynak: <code>butonlar.json</code></div>
</div>

<script>
const JSON_PATH = "butonlar.json";
let fileData = {};

function escapeHtml(s){ if(!s) return ""; return String(s).replace(/[&<>"']/g, m=>({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[m])); }

function renderButtons(list){
  const c = document.getElementById("buttons"); c.innerHTML = "";
  (list||[]).forEach(it=>{
    const b = document.createElement("div"); b.className = "btn"; b.tabIndex = 0;
    const icon = escapeHtml(it.icon || "ðŸ”—");
    const label = escapeHtml(it.label || "");
    let sub = "";
    if(it.type === "mail") sub = escapeHtml(it.mail || "E-posta");
    else if(it.type === "dosya") sub = (fileData[it.id]?.name || "Dosya");
    else sub = escapeHtml(it.url || "");
    b.innerHTML = '<div class="icon" aria-hidden="true">'+ icon +'</div>' +
                  '<div style="min-width:0"><div class="label">'+ label +'</div>' +
                  '<div class="sublabel">'+ sub +'</div></div>';
    b.addEventListener("click", ()=> openItem(it));
    b.addEventListener("keydown", (e)=>{ if(e.key === "Enter") openItem(it); });
    c.appendChild(b);
  });
}

function openItem(it){
  if(it.type === "mail"){
    const mail = it.mail || "";
    if(!mail){ alert("Bu buton iÃ§in e-posta adresi yok."); return; }
    window.location.href = "mailto:" + mail; return;
  }
  if(it.type === "dosya"){
    const f = fileData[it.id];
    if(!f){ alert("Bu butona dosya baÄŸlÄ± deÄŸil."); return; }
    const href = f.href || f.dataUrl; // href (normal URL) ya da dataUrl (base64)
    if(!href){ alert("Dosya URL'i bulunamadÄ±."); return; }
    const a = document.createElement("a"); a.href = href; a.download = f.name || ""; a.click(); return;
  }
  if(it.url){ window.open(it.url, "_blank", "noopener"); return; }
  alert("Bu buton iÃ§in iÅŸlem tanÄ±mlÄ± deÄŸil.");
}

async function loadJSON(){
  const res = await fetch(JSON_PATH, { cache: "no-store" });
  if(!res.ok) throw new Error("butonlar.json bulunamadÄ±");
  const j = await res.json();
  // Esnek ÅŸema:
  // 1) DÃ¼z liste: [ {...}, {...} ]
  // 2) Nesne: { data:[...], files:{ "id": {name, href|dataUrl} } }
  if(Array.isArray(j)) return { data: j, files: {} };
  return { data: j.data || [], files: j.files || {} };
}

loadJSON()
  .then(({data, files}) => { fileData = files || {}; renderButtons(data || []); })
  .catch(err => {
    console.error(err);
    document.getElementById("buttons").innerHTML = "<div style='color:#ff8080'>butonlar.json yÃ¼klenemedi.</div>";
  });
</script>
</body>
</html>
